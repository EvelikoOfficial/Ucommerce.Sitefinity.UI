@model  IList<Ucommerce.Sitefinity.UI.Mvc.ViewModels.FacetViewModel>

@using Newtonsoft.Json;
@using Telerik.Sitefinity.Services
@using Telerik.Sitefinity.Frontend.Mvc.Helpers

@Html.StyleSheet(Url.WidgetContent("~/ResourcePackages/Bootstrap4/assets/dist/css/main.min.css"), "head")

@if (!SystemManager.IsDesignMode)
{
    @Html.Script(Url.WidgetContent("assets/build/js/vendor.bundle.js"), "bottom", false)
    @Html.Script(Url.WidgetContent("assets/build/js/main.js"), "bottom", false)
}

<div class="mb-4" data-component="facet-selector" id="@Html.UniqueId("facetFilter")">
    <script type="application/json" data-facets="true">
        { "facets" : @Html.Raw(JsonConvert.SerializeObject(Model)) }
    </script>
    <h2 class="h2">
        Filter products
    </h2>
    <a class="text-info h4" v-on:click="clearFilters">Clear filter</a>

    <ul class="list-group mt-4" v-cloak>
        <li class="list-group-item" v-for="facet in facets" v-bind:key="facet.DisplayName">
            <h3 class="h3">by {{ facet.DisplayName }}</h3>
            <ul class="list-group mt-3">
                <li class="list-group-item" v-for="filter in facet.FacetValues" v-bind:style="filter.FacetValueHits == 0 && {'opacity' : 0.5}">
                    <label class="form-check-label" v-bind:class="filter.Checked && 'active'">
                        <input type="checkbox" class="form-check-input mt-0" v-model="filter.Checked" v-on:change="filterProducts(filter)" v-bind:key="filter.FacetValueName" />
                        <span class="pl-4 h5">{{ filter.FacetValueName }}</span>
                    </label>
                    <span class="pl-4 h5 text-info"> ({{ filter.FacetValueHits }})</span>
                </li>
            </ul>
        </li>
    </ul>
</div>
